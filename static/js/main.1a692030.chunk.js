(this["webpackJsonpreact-tutorial"]=this["webpackJsonpreact-tutorial"]||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r=n(28),a=n.n(r),c=(n(39),n(6)),s=(n(40),n(13)),i=n(34),o=n(29),u=n.n(o),l=(n(41),n(0)),h=["text","noOverlay","className"];var p=function(e){var t=e.text,n=e.noOverlay,r=e.className,a=Object(i.a)(e,h),c=u()("Spinner",n&&"Spinner--noOverlay",r);return Object(l.jsxs)("div",Object(s.a)(Object(s.a)({},a),{},{className:c,children:[Object(l.jsx)("div",{className:"Spinner-spinner",children:Object(l.jsx)("svg",{viewBox:"0 0 64 64",children:Object(l.jsx)("circle",{transform:"translate(32,32)",r:"26"})})}),t?Object(l.jsx)("div",{className:"Spinner-content",children:t}):null]}))},b=n(1),d=n(11);n(43);var f,j=function(e){var t=e.isAuthorized;return Object(l.jsxs)("div",{className:"navbar",children:[!t&&Object(l.jsx)(d.b,{to:"/login",children:"Login"}),t&&Object(l.jsx)(d.b,{to:"/vendors",children:"Vendors"}),Object(l.jsx)(d.b,{to:"/settings",children:"Settings"})]})},v=n(4),m=n(2),O=n.n(m),x=n(3),y=n(32),g=n.n(y),k=n(10),w=n(12),S=n(18),I=n(17),N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return window.localStorage};Object(k.a)(this,e),this.storage=void 0,this.storage=t()}return Object(w.a)(e,[{key:"get",value:function(e){return this.storage.getItem(e)}},{key:"set",value:function(e,t){this.storage.setItem(e,t)}},{key:"clearItem",value:function(e){this.storage.removeItem(e)}},{key:"clearItems",value:function(e){var t=this;e.forEach((function(e){return t.clearItem(e)}))}}]),e}();!function(e){e.ALL_TOKENS="all_tokens"}(f||(f={}));var R=function(e){Object(S.a)(n,e);var t=Object(I.a)(n);function n(){return Object(k.a)(this,n),t.call(this)}return Object(w.a)(n,[{key:"setAllTokens",value:function(e){this.set(f.ALL_TOKENS,JSON.stringify(e))}},{key:"getAllTokens",value:function(){var e=this.get(f.ALL_TOKENS);return e?JSON.parse(e):null}},{key:"clear",value:function(){this.clearItems([f.ALL_TOKENS])}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(N);R.instance=void 0;var M="07aedeb85a0441668d6755de78407538",T="38988",D="dBElXQcNpvR84zmqMTI0gPwo022Sdu.EXZhrxy.HVPo",C="https://www.bungie.net",L="".concat(C,"/Platform");function _(){return E.apply(this,arguments)}function E(){return(E=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=R.getInstance().getAllTokens())||R.getInstance().clear(),!(t&&!V(t.accessToken))){e.next=5;break}return e.abrupt("return",t);case 5:if(t&&!V(t.refreshToken)||console.log("We need to fetch a new token here"),e.prev=7,!t){e.next=12;break}return e.next=11,G(t.refreshToken);case 11:return e.abrupt("return",e.sent);case 12:throw new Error;case 15:throw e.prev=15,e.t0=e.catch(7),new Error("I dunno");case 18:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}function F(e){return P.apply(this,arguments)}function P(){return(P=Object(x.a)(O.a.mark((function e(t){var n,r,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:if(n=e.sent){e.next=6;break}throw console.error("We need a new token"),new Error("Some token error");case 6:if(r={authorization:"Bearer ".concat(n.accessToken.value),"x-api-key":M},a=t.url,t.params){for(c in t.params)"undefined"===typeof t.params[c]&&delete t.params[c];a="".concat(a,"?").concat(new URLSearchParams(t.params).toString())}return e.abrupt("return",fetch(a,{method:t.method,body:t.body,headers:r}).then((function(e){return e.json()})));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return H.apply(this,arguments)}function H(){return(H=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t.url,{method:t.method,body:t.body}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){var t=new URLSearchParams({grant_type:"authorization_code",code:e,client_id:T,client_secret:D});return fetch("".concat(L,"/app/oauth/token/"),{method:"POST",body:t}).then((function(e){return e.json()})).then(B).then((function(e){return R.getInstance().setAllTokens(e)}))}function B(e){if(null===e||void 0===e?void 0:e.access_token){var t=e,n=Date.now(),r={accessToken:{value:t.access_token,expires:t.expires_in,name:"access",inception:n},bungieMembershipId:t.membership_id};return t.refresh_token&&(r.refreshToken={value:t.refresh_token,expires:t.refresh_expires_in,name:"refresh",inception:n}),r}throw new Error("No tokens")}function G(e){var t=new URLSearchParams({grant_type:"refresh_token",refresh_token:e.value,client_id:T,client_secret:D});return Promise.resolve(fetch("".concat(L,"/app/oauth/token/"),{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return e.ok?e.json():Promise.reject(e)})).then(B).then((function(e){return R.getInstance().setAllTokens(e),e})))}function V(e){if(!e)return!0;var t=1e3*e.expires+e.inception;return Date.now()>t}n(55);var J=function(){var e=Object(v.g)(),t=function(){var t=Object(x.a)(O.a.mark((function t(n){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.code,t.next=3,z(r);case 3:e.push("/vendors");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(l.jsx)(g.a,{authorizationUrl:"https://www.bungie.net/en/Oauth/Authorize",responseType:"code",clientId:T,redirectUri:"https://mlsof21.github.io/d2-vendor-pages/%23/callback",onSuccess:t,onFailure:function(e){return console.log(e)},buttonText:"Login with Bungie.net",className:"loginButton"})};var U=function(){var e=new URLSearchParams(Object(v.h)().search).get("code");return Object(l.jsx)(l.Fragment,{children:!e&&Object(l.jsx)(l.Fragment,{children:e})})},K=n(20),X=n(64),W=n(65);function Y(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(x.a)(O.a.mark((function e(t){var n,r,a,c,s,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(X.b)(F,{membershipId:t,membershipType:254,getAllMemberships:!0}).then((function(e){return e.Response}));case 2:return n=e.sent,r=n.profiles[0].membershipId,a=n.profiles[0].membershipType,e.next=7,Object(X.c)(F,{destinyMembershipId:r,components:[200],membershipType:a}).then((function(e){return e.Response}));case 7:return c=e.sent,s=q(c),i={bungieMembershipId:t,destinyMembershipId:r,membershipType:a,hunterId:s.hunter,titanId:s.titan,warlockId:s.warlock},e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){var t=null,n=null,r=null;if(e.characters.data){var a=e.characters.data;Object.keys(e.characters.data).forEach((function(e){switch(a[e].classType){case 0:n=e;break;case 1:t=e;break;case 2:r=e;break;default:throw new Error("Unknown class type")}}))}return{hunter:t,titan:n,warlock:r}}function Q(){return $.apply(this,arguments)}function $(){return($=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(X.a)(A);case 2:return t=e.sent,e.abrupt("return",t.Response);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return(te=Object(x.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:return t=e.sent,e.next=5,Object(W.a)(A,{destinyManifest:t,language:"en",tableNames:["DestinyInventoryItemDefinition","DestinyStatDefinition"]});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){var t=e.hunterId,n=e.titanId,r=e.warlockId,a=[];return n&&a.push({id:n,classType:0}),t&&a.push({id:t,classType:1}),r&&a.push({id:r,classType:2}),a}function re(e){return ae.apply(this,arguments)}function ae(){return ae=Object(x.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ne(t),r={},e.next=4,Promise.all(n.map(function(){var e=Object(x.a)(O.a.mark((function e(n){var a,c,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.id,c=n.classType,e.next=3,ce(a,t.destinyMembershipId,t.membershipType);case 3:s=e.sent,r[c]=s;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}function ce(e,t,n){return se.apply(this,arguments)}function se(){return(se=Object(x.a)(O.a.mark((function e(t,n,r){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(X.d)(F,{characterId:t,components:[304,402],destinyMembershipId:n,membershipType:r});case 2:return a=e.sent,e.abrupt("return",a.Response);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(56),n(57);var ie=function(e){var t=e.stat,n={height:"100%",width:"".concat(t?t/30*100:0,"%"),backgroundColor:"white"};return Object(l.jsx)("div",{className:"barContainer",style:{height:"100%",width:"100%",backgroundColor:"grey"},children:Object(l.jsx)("div",{style:n,children:Object(l.jsx)("span",{style:{padding:10,color:"black",fontWeight:900}})})})};n(58);var oe=function(e){var t=e.armorStats;return Object(l.jsxs)("div",{className:"statsContainer",children:[Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Mobility:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Mobility}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Mobility})]}),Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Resilience:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Resilience}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Resilience})]}),Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Recovery:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Recovery}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Recovery})]}),Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Discipline:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Discipline}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Discipline})]}),Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Intellect:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Intellect}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Intellect})]}),Object(l.jsxs)("div",{className:"stat",children:[Object(l.jsx)("div",{className:"statLabel",children:Object(l.jsx)("span",{children:"Strength:"})}),Object(l.jsx)("div",{className:"statValue",children:null===t||void 0===t?void 0:t.Strength}),Object(l.jsx)(ie,{stat:null===t||void 0===t?void 0:t.Strength})]})]})};var ue=function(e){var t=e.armorInfo,n=e.show,r=e.onClickOutside,a=e.top,c=e.left,s=Object(b.useRef)(null),i=function(e){var t;e.target&&(s.current&&!(null===(t=s.current)||void 0===t?void 0:t.contains(e.target))&&r&&r())};Object(b.useEffect)((function(){return document.addEventListener("click",i,!0),function(){document.removeEventListener("click",i,!0)}}));var o={top:a,left:c};return n?Object(l.jsxs)("div",{ref:s,className:"modal",style:o,children:[Object(l.jsx)("h3",{children:null===t||void 0===t?void 0:t.name}),Object(l.jsxs)("div",{className:"imgAndFlavor",children:[Object(l.jsx)("img",{src:null===t||void 0===t?void 0:t.iconPath}),Object(l.jsx)("span",{children:null===t||void 0===t?void 0:t.flavorText})]}),Object(l.jsx)(oe,{armorStats:null===t||void 0===t?void 0:t.stats})]}):Object(l.jsx)(l.Fragment,{})},le={1:"Hunter",0:"Titan",2:"Warlock"},he=[1,0,2],pe={350061650:"Ada-1",396892126:"Devrim",248695599:"Drifter",1576276905:"Failsafe",3603221665:"Shaxx",2190858386:"Xur",69482069:"Zavala"},be={2996146975:"Mobility",392767087:"Resilience",1943323491:"Recovery",1735777505:"Discipline",144602215:"Intellect",4244567218:"Strength"},de={26:"Helmet",27:"Gauntlets",28:"Chest",29:"Legs"},fe=n(19),je=n(26);function ve(e){return me.apply(this,arguments)}function me(){return(me=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.a)("destiny2-store",1,{upgrade:function(e){e.createObjectStore("d2")}});case 2:return n=e.sent,e.abrupt("return",n.get("d2",t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t){return xe.apply(this,arguments)}function xe(){return(xe=Object(x.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.a)("destiny2-store",1,{upgrade:function(e){e.createObjectStore("d2")}});case 2:return r=e.sent,e.abrupt("return",r.put("d2",n,t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe("DestinyInventoryItemDefinition",t.DestinyInventoryItemDefinition);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){return we.apply(this,arguments)}function we(){return(we=Object(x.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve("DestinyInventoryItemDefinition");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Se,Ie=n(33),Ne=n.n(Ie);!function(e){e.SCORING="scoring"}(Se||(Se={}));var Re=function(e){Object(S.a)(n,e);var t=Object(I.a)(n);function n(){return Object(k.a)(this,n),t.call(this)}return Object(w.a)(n,[{key:"getScoring",value:function(){var e=this.get(Se.SCORING);if(e)return JSON.parse(e)}},{key:"setScoring",value:function(e){this.set(Se.SCORING,e)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(N);Re.instance=void 0;var Me=function(){function e(t){Object(k.a)(this,e),this.Mobility=0,this.Resilience=0,this.Recovery=0,this.Discipline=0,this.Intellect=0,this.Strength=0,Object.assign(this,t)}return Object(w.a)(e,[{key:"getSortedSubGroup1",value:function(){return[this.Mobility,this.Resilience,this.Recovery].sort((function(e,t){return t-e}))}},{key:"getSortedSubGroup2",value:function(){return[this.Discipline,this.Intellect,this.Strength].sort((function(e,t){return t-e}))}}]),e}();function Te(e,t){var n=function(e){var t=Re.getInstance();switch(e){case 0:return function(e){var t=e.getScoring();if(t)return new Me(t[0]);return new Me({Recovery:3,Discipline:2,Resilience:1})}(t);case 1:return function(e){var t=e.getScoring();if(t)return new Me(t[1]);return new Me({Recovery:3,Discipline:2,Mobility:1})}(t);case 2:return function(e){var t=e.getScoring();if(t)return new Me(t[2]);return new Me({Recovery:3,Discipline:3})}(t)}return new Me}(t),r=function(e,t){var n=0;return n+=e.Mobility*t.Mobility,n+=e.Resilience*t.Resilience,n+=e.Recovery*t.Recovery,n+=e.Discipline*t.Discipline,n+=e.Intellect*t.Intellect,n+=e.Strength*t.Strength}(e,n),a=function(e){for(var t=e.getSortedSubGroup1(),n=e.getSortedSubGroup2(),r=[[2,10,10],[2,2,20]],a=Number.MAX_VALUE,c=0,s=r;c<s.length;c++){for(var i=s[c],o=0,u=0,l=0;l<3;l++)o+=t[l]*i[l],u+=n[l]*i[l];o+u<a&&(a=o+u)}return a}(n),c=function(e){var t=30,n=2,r=e.getSortedSubGroup1(),a=e.getSortedSubGroup2();return t*(r[0]+a[0])+n*(r[1]+r[2]+a[1]+a[2])}(n),s=function(e,t,n){return Math.round((e-t)/Math.max(n-t,1)*100)}(r,a,c);return{rawScore:r,normalizedScore:s,theoreticalMax:c,theoreticalMin:a}}function De(e){var t=Ne()(["#FF0000","#00FF00"]);return{colorHex:t.rgb(Math.max(e.theoreticalMax-e.theoreticalMin,2))[Math.max(e.rawScore-e.theoreticalMin-1,0)].toHexString(),normalizedColorHex:t.rgb(100)[Math.max(e.normalizedScore-1,0)].toHexString()}}function Ce(){return new Me({Mobility:1,Resilience:1,Recovery:1,Discipline:1,Intellect:1,Strength:1})}function Le(e){return _e.apply(this,arguments)}function _e(){return(_e=Object(x.a)(O.a.mark((function e(t){var n,r,a,c,s,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r=Object.keys(t).map((function(e){return parseInt(e)})),e.next=4,ke();case 4:a=e.sent,c=Object(fe.a)(r),e.prev=6,i=O.a.mark((function e(){var r,c,i,o,u,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.value,n[r]={},c=Object.keys(t[r].itemComponents).map((function(e){return parseInt(e)})),i=Object.keys(pe).map((function(e){return parseInt(e)})).filter((function(e){return c.includes(e)})),o=Object(fe.a)(i),e.prev=5,o.s();case 7:if((u=o.n()).done){e.next=14;break}return l=u.value,e.next=11,Pe(t[r],l,a);case 11:n[r][l]=e.sent;case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),o.e(e.t0);case 19:return e.prev=19,o.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[5,16,19,22]])})),c.s();case 9:if((s=c.n()).done){e.next=13;break}return e.delegateYield(i(),"t0",11);case 11:e.next=9;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(6),c.e(e.t1);case 18:return e.prev=18,c.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[6,15,18,21]])})))).apply(this,arguments)}var Ee,Fe=function e(t){Object(k.a)(this,e),this.Mobility=0,this.Resilience=0,this.Recovery=0,this.Discipline=0,this.Intellect=0,this.Strength=0,Object.assign(this,t)};function Pe(e,t,n){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(x.a)(O.a.mark((function e(t,n,r){var a,c,s,i,o,u,l,h,p,b,d,f;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},t.sales.data){c=Object.keys(t.sales.data[n].saleItems).map((function(e){return parseInt(e)})),s=t.sales.data[n].saleItems,i=Object(fe.a)(c);try{for(i.s();!(o=i.n()).done;)u=o.value,l=s[u].itemHash,h=r[l].itemSubType,p=r[l].summaryItemHash,b="".concat(C).concat(r[l].displayProperties.icon),d=r[l].displayProperties.name,f=r[l].flavorText,He(h)&&715326750!==p&&(a[h]={itemHash:l,saleKey:u,armorType:de[h],iconPath:b,name:d,flavorText:f})}catch(j){i.e(j)}finally{i.f()}}return e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e){return Object.keys(de).map((function(e){return parseInt(e)})).includes(e)}function ze(e,t){return Be.apply(this,arguments)}function Be(){return(Be=Object(x.a)(O.a.mark((function e(t,n){var r,a,c,s,i,o,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t)for(a in t[r])for(c in t[r][a])n[r].itemComponents[a].stats.data&&(s=t[r][a][c].saleKey,i=n[r].itemComponents[a].stats.data[s],t[r][a][c].stats=Ge(i.stats),o=Te(t[r][a][c].stats,parseInt(r)),u=De(o),t[r][a][c].rawScore=o.rawScore,t[r][a][c].normalizedScore=o.normalizedScore,t[r][a][c].colors=u,t[r][a][c].theoreticalMax=o.theoreticalMax);return e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(e){var t=new Fe;for(var n in e)switch(be[n]){case"Mobility":t.Mobility=e[n].value;break;case"Resilience":t.Resilience=e[n].value;break;case"Recovery":t.Recovery=e[n].value;break;case"Discipline":t.Discipline=e[n].value;break;case"Intellect":t.Intellect=e[n].value;break;case"Strength":t.Strength=e[n].value;break;default:throw new Error("No idea what stat this is")}return t}!function(e){e.MEMBERSHIP_INFO="membership_info"}(Ee||(Ee={}));var Ve=function(e){Object(S.a)(n,e);var t=Object(I.a)(n);function n(){return Object(k.a)(this,n),t.call(this)}return Object(w.a)(n,[{key:"getMembershipInfo",value:function(){var e=this.get(Ee.MEMBERSHIP_INFO);if(e)return JSON.parse(e)}},{key:"setMembershipInfo",value:function(e){this.set(Ee.MEMBERSHIP_INFO,e)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(N);Ve.instance=void 0;n(60);var Je=function(){var e=Object(v.g)(),t=Object(b.useState)(!0),n=Object(c.a)(t,2),r=n[0],a=n[1],s=Object(b.useState)("Loading Destiny manifest"),i=Object(c.a)(s,2),o=i[0],u=i[1],h=Object(b.useState)(),d=Object(c.a)(h,2),f=d[0],j=d[1],m=Object(b.useState)(!0),y=Object(c.a)(m,2),g=y[0],k=y[1],w=Object(b.useState)({0:0,1:0,2:0}),S=Object(c.a)(w,2),I=S[0],N=S[1],M=Object(b.useState)(Object(K.a)(he)),T=Object(c.a)(M,2),D=T[0],C=T[1],L=Object(b.useState)([350061650,396892126,248695599,1576276905,3603221665,2190858386,69482069]),_=Object(c.a)(L,2),E=_[0],F=_[1],P=Object(b.useState)(!1),A=Object(c.a)(P,2),H=A[0],z=A[1],B=Object(b.useState)({}),G=Object(c.a)(B,2),V=G[0],J=G[1],U=Object(b.useState)({top:0,left:0}),X=Object(c.a)(U,2),W=X[0],Z=X[1],q=R.getInstance(),Q=Ve.getInstance(),$=q.getAllTokens(),te="";if(!$)return console.info("Redirecting to Login"),e.push("/Login"),Object(l.jsx)(l.Fragment,{});$&&(te=null===$||void 0===$?void 0:$.bungieMembershipId);var ne=Ve.getInstance().getMembershipInfo();function ae(){return(ae=Object(x.a)(O.a.mark((function e(){var t,n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:if(e.sent){e.next=10;break}return e.next=6,ee();case 6:return t=e.sent,u("Storing manifest"),e.next=10,ye(t);case 10:if(ne){e.next=16;break}return u("Fetching Bungie Member Info"),e.next=14,Y(te);case 14:ne=e.sent,Q.setMembershipInfo(JSON.stringify(ne));case 16:if(!ne){e.next=32;break}return u("Fetching Vendor Inventories"),e.next=20,re(ne);case 20:return n=e.sent,u("Getting scorable armor"),e.next=24,Le(n);case 24:return r=e.sent,u("Scoring armor"),e.next=28,ze(r,n);case 28:c=e.sent,ce(c),se(c),j(c);case 32:a(!1);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(b.useEffect)((function(){!function(){ae.apply(this,arguments)}()}),[]);var ce=function(e){for(var t=parseInt(Object.keys(e[0])[0]),n={},r=0;r<3;r++)r in e&&e[r][t][26].theoreticalMax&&(n[r]=e[r][t][26].theoreticalMax);N(n)},se=function(e){var t=Object.keys(e).map((function(e){return parseInt(e)})),n=D.filter((function(e){return t.includes(e)}));C(Object(K.a)(n));var r=Object.keys(e[n[0]]).map((function(e){return parseInt(e)})),a=E.filter((function(e){return r.includes(e)}));F(Object(K.a)(a))};return Object(l.jsxs)("div",{children:[!r&&Object(l.jsxs)("label",{children:["Show Normalized Scores (0-100)",Object(l.jsx)("input",{type:"checkbox",checked:g,onChange:function(){return k(!g)}})]}),r&&Object(l.jsx)(p,{text:o,noOverlay:!0}),Object(l.jsxs)("div",{className:"vendorTable",children:[f&&D.map((function(e){return Object(l.jsx)("table",{className:"table--flip",children:Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsxs)("th",{children:[le[e]," ",!g&&"(".concat(I[e],")")]}),E.map((function(e){return Object(l.jsx)("th",{children:pe[e]},e)}))]}),Object.keys(de).map((function(e){return parseInt(e)})).map((function(t){return Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{scope:"row",children:de[t]}),E.map((function(n){var r,a;return Object(l.jsx)("td",{className:"scoreCell",style:{backgroundColor:g?null===(r=f[e][n][t].colors)||void 0===r?void 0:r.normalizedColorHex:null===(a=f[e][n][t].colors)||void 0===a?void 0:a.colorHex},children:Object(l.jsx)("button",{onClick:function(r){return function(e,t){z(!H),J(t),Z({top:e.pageY,left:e.pageX}),console.log("Clicked item hash ".concat(t.itemHash))}(r,f[e][n][t])},children:g?f[e][n][t].normalizedScore:f[e][n][t].rawScore})},n)}))]},t)}))]})},e)})),Object(l.jsx)(ue,{armorInfo:V,show:H,onClickOutside:function(){z(!1)},top:W.top,left:W.left})]})]})},Ue=n(22);n(61);var Ke=function(){var e=Re.getInstance(),t=e.getScoring(),n=t?{0:new Me(t[0]),1:new Me(t[1]),2:new Me(t[2])}:{0:Ce(),1:Ce(),2:Ce()},r=Object(b.useState)(n),a=Object(c.a)(r,2),i=a[0],o=a[1],u=Object(b.useState)("Save Changes"),h=Object(c.a)(u,2),p=h[0],d=h[1],f=Object(K.a)(he);function j(e){var t=e.target,n=t.name,r=t.value,a=n.split("-"),u=Object(c.a)(a,2),l=u[0],h=u[1],p=i[parseInt(l)];"Mobility"===h&&(p.Mobility=parseInt(r)),"Resilience"===h&&(p.Resilience=parseInt(r)),"Recovery"===h&&(p.Recovery=parseInt(r)),"Discipline"===h&&(p.Discipline=parseInt(r)),"Intellect"===h&&(p.Intellect=parseInt(r)),"Strength"===h&&(p.Strength=parseInt(r)),o(Object(s.a)(Object(s.a)({},i),{},Object(Ue.a)({},parseInt(l),p))),console.log("changing ".concat(n," to ").concat(r))}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h2",{children:"Scoring Settings"}),Object(l.jsxs)("p",{children:["Configure your own scoring here. This will affect the scores you see on the main page. For example, if you only value ",Object(l.jsx)("code",{children:"Recovery"})," on armor, you would set the ",Object(l.jsx)("code",{children:"Recovery"})," field for your classes below to a number. The score you would see for vendor armor would be: (",Object(l.jsx)("code",{children:"Recovery * number"}),")"]}),Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.setScoring(JSON.stringify(i)),d("Saved!"),setTimeout((function(){return d("Save Changes")}),2e3)},children:[Object(l.jsx)("div",{className:"settings",children:f.map((function(e){return Object(l.jsxs)("div",{className:"characterSettings",children:[Object(l.jsx)("h3",{children:le[e]}),Object(l.jsxs)("label",{children:["Mobility:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Mobility"),onChange:j,value:i[e].Mobility,className:"statInput",min:"0"})," "]}),Object(l.jsxs)("label",{children:["Resilience:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Resilience"),onChange:j,value:i[e].Resilience,className:"statInput",min:"0"})," "]}),Object(l.jsxs)("label",{children:["Recovery:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Recovery"),onChange:j,value:i[e].Recovery,className:"statInput",min:"0"})," "]}),Object(l.jsxs)("label",{children:["Discipline:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Discipline"),onChange:j,value:i[e].Discipline,className:"statInput",min:"0"})," "]}),Object(l.jsxs)("label",{children:["Intellect:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Intellect"),onChange:j,value:i[e].Intellect,className:"statInput",min:"0"})," "]}),Object(l.jsxs)("label",{children:["Strength:"," ",Object(l.jsx)("input",{type:"number",name:"".concat(e,"-Strength"),onChange:j,value:i[e].Strength,className:"statInput",min:"0"})," "]})]},e)}))}),Object(l.jsx)("input",{type:"button",value:"Clear Scoring",onClick:function(){o({0:Ce(),1:Ce(),2:Ce()})}}),Object(l.jsx)("input",{type:"submit",value:p,onChange:j})]})]})};var Xe=function(){var e=Object(b.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=(t[1],!!R.getInstance().getAllTokens());return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(j,{isAuthorized:r}),Object(l.jsxs)(v.d,{children:[Object(l.jsx)(v.b,{exact:!0,path:"/login",component:J}),Object(l.jsx)(v.b,{exact:!0,path:"/vendors",component:Je}),Object(l.jsx)(v.b,{exact:!0,path:"/",component:Je}),Object(l.jsx)(v.b,{exact:!0,path:"/callback",component:U}),Object(l.jsx)(v.b,{exact:!0,path:"/settings",component:Ke}),Object(l.jsx)(v.a,{to:"/"})]}),n&&Object(l.jsx)(p,{text:"Loading Destiny manifest",noOverlay:!1})]})},We=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,66)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};a.a.render(Object(l.jsx)(d.a,{children:Object(l.jsx)(Xe,{})}),document.getElementById("root")),We()}},[[62,1,2]]]);
//# sourceMappingURL=main.1a692030.chunk.js.map